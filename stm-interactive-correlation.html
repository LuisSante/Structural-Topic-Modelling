
  <!DOCTYPE html><meta charset=UTF-8>
  <style>.node rect{cursor:pointer;fill:#fff;fill-opacity:.5;stroke:#3182bd;stroke-width:1.5px;}
  .node text{font:10px sans-serif;pointer-events:none;}
  path.link{fill:none;stroke:#9ecae1;stroke-width:1.5px;}
  .control.glyphicon{position:static;color:#4A4C4F;font-family:"Oxygen", sans-serif;cursor:pointer;}
  .scrollbox{height: 120px;border: 1px solid #e5e5e5;overflow: scroll;}
  .bar{fill: steelblue;}.axis{font: 10px sans-serif;}.axis path,.axis line{fill: none; stroke: #000;
  shape-rendering: crispEdges;}.x.axis path{display: none;}</style>
  <link href="https://fonts.googleapis.com/css?family=Oxygen" rel=stylesheet type="text/css">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel=stylesheet>
  <title>STM Visualization</title><body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <script>var margin={top:30,right:20,bottom:30,left:20},width=window.innerWidth/1.5-margin.left-margin.right,height=window.innerHeight-margin.top-margin.bottom,barHeight=20,barWidth=width*.8;
  var i=0,duration=400,root;var tree=d3.layout.tree().nodeSize([0,20]);var diagonal=d3.svg.diagonal().projection(function(d){return[d.y,d.x];});
  var svg=d3.select("body").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");
  root= {"children":[{"name":["cuenta, app, puedo, sale, llave, problema, pued"],"children":[{"name":["cuenta, crear, dni, banco, solucion, numero, dinero"],"children":[{"name":["dni, crear, foto, reconoc, contraseña, validar, cambi"],"size":[1800],"topic_no":[11],"thought_1":[],"thought_2":[],"prob":["cuenta, dni, numero, crear, dato, tarjeta, clave"],"frex":["dni, crear, foto, reconoc, contraseña, validar, cambi"],"lift":["dnino, absuelvan, acamara, actualno, acuerd, admiten, afiliarmeno"],"score":["cuenta, dni, crear, numero, foto, codigo, clave"],"proportion":["0.05"]},{"name":["dan, nadi, estafa, figura, soport, facebook, reclamo"],"size":[1800],"topic_no":[15],"thought_1":[],"thought_2":[],"prob":["dinero, solucion, banco, saldo, nunca, sole, ver"],"frex":["dan, nadi, estafa, figura, soport, facebook, reclamo"],"lift":["acudo, aduciendo, analista, anteriormenteno, ayudart, burlan, cambiaran"],"score":["solucion, sole, saldo, dinero, nunca, banco, mapeo"],"proportion":["0.05"]}],"topic_no":[11,15]},{"name":["deja, funciona, necesito, app, pesimo, actualizacion, actualizar"],"children":[{"name":["demora, basura, funcionar, cae, porqueria, demasiado, mod"],"size":[1800],"topic_no":[18],"thought_1":[],"thought_2":[],"prob":["app, deja, actualizacion, pesimo, pesima, falla, demora"],"frex":["demora, basura, funcionar, cae, porqueria, demasiado, mod"],"lift":["cayendo, inest, demora, abren, aparecera, appultimo, arruina"],"score":["app, deja, pesimo, pesima, actualizacion, falla, demora"],"proportion":["0.05"]},{"name":["actualizar, trist, actualiza, descontento, lento, store, impresionado"],"size":[1800],"topic_no":[19],"thought_1":[],"thought_2":[],"prob":["actualizar, funciona, necesito, sirv, pide, trist, actualiza"],"frex":["actualizar, trist, actualiza, descontento, lento, store, impresionado"],"lift":["actualizando, actualicehacerlo, actualiceintento, actualicemo, actualiceno, actualicesin, actualizacionluego"],"score":["actualizar, funciona, trist, pide, necesito, actualiza, descontento"],"proportion":["0.04"]}],"topic_no":[18,19]},{"name":["tard, ocurrio, intentalo, intentelo, requier, error, minuto"],"size":[1800],"topic_no":[7],"thought_1":[],"thought_2":[],"prob":["sale, problema, mas, error, vece, cada, vez"],"frex":["tard, ocurrio, intentalo, intentelo, requier, error, minuto"],"lift":["abia, adm, ana, cargarla, conocert, desfavor, encontrado"],"score":["sale, error, problema, mas, tard, cada, intent"],"proportion":["0.06"]},{"name":["entrar, dia, mal, hace, favor, puedo, ingresar"],"children":[{"name":["mal, queda, cargando, causa, sarcasmo, logo, morada"],"size":[1800],"topic_no":[5],"thought_1":[],"thought_2":[],"prob":["dia, ingresar, entrar, mal, hace, pasa, carga"],"frex":["mal, queda, cargando, causa, sarcasmo, logo, morada"],"lift":["apagu, aplicacionay, appigu, cerra, cerrarlo, conectada, ingresaroslo"],"score":["ingresar, entrar, mal, dia, salio, carga, queda"],"proportion":["0.06"]},{"name":["confundido, virus, bajar, incierto, fallando, desinstalarlo, noch"],"size":[1800],"topic_no":[6],"thought_1":[],"thought_2":[],"prob":["puedo, favor, instalar, abr, paso, fallando, actualic"],"frex":["confundido, virus, bajar, incierto, fallando, desinstalarlo, noch"],"lift":["actualicemomento, actualicequiero, actualizarcada, actualmenteaplicacion, afectada, aida, antivirus"],"score":["puedo, instalar, favor, abr, fallando, paso, actualic"],"proportion":["0.04"]}],"topic_no":[5,6]},{"name":["pued, descargar, alguien, administrador, dispositivo, privilegio, acceso"],"size":[1800],"topic_no":[3],"thought_1":[],"thought_2":[],"prob":["pued, quiero, descargar, ser, dice, hola, pueden"],"frex":["pued, descargar, alguien, administrador, dispositivo, privilegio, acceso"],"lift":["abrira, abrirm, administrad, administradorno, adquirido, alim, apearsel"],"score":["pued, privilegio, administrador, descargar, dispositivo, denegado, ser"],"proportion":["0.03"]},{"name":["llave, ahora, ant, actualizacion, hacer, bcp, celular"],"children":[{"name":["hacian, incompat, probando, choti, top, sonido, kan"],"size":[1800],"topic_no":[9],"thought_1":[],"thought_2":[],"prob":["llave, celular, bcp, despu, pasando, sonido, cambio"],"frex":["hacian, incompat, probando, choti, top, sonido, kan"],"lift":["choti, acedera, alarma, avisarno, buenaextraño, caist, cajon"],"score":["llave, celular, bcp, despu, pasando, sonido, suena"],"proportion":["0.03"]},{"name":["mantenimiento, ant, plan, malo, casi, realment, dificil"],"size":[1800],"topic_no":[20],"thought_1":[],"thought_2":[],"prob":["ahora, hacer, actualizacion, ant, verdad, nueva, mantenimiento"],"frex":["mantenimiento, ant, plan, malo, casi, realment, dificil"],"lift":["actualizarlono, buenajusto, entregan, ineficaz, pacens, problemanueva, recargaba"],"score":["ahora, hacer, ant, actualizacion, mantenimiento, verdad, nueva"],"proportion":["0.03"]}],"topic_no":[9,20]},{"name":["ojala, simplement, buenaza, trabajar, queja, increibl, totalment"],"size":[1800],"topic_no":[14],"thought_1":[],"thought_2":[],"prob":["espero, client, ojala, asi, simplement, seguir, buenaza"],"frex":["ojala, simplement, buenaza, trabajar, queja, increibl, totalment"],"lift":["abp, acto, actualizarl, agricultor, aliado, alta, amaia"],"score":["espero, client, buenaza, increibl, simplement, queja, ojala"],"proportion":["0.01"]},{"name":["tener, solo, hora, mapear, opcion, poder, tiempo"],"children":[{"name":["perdida, godo, rey, good, engañoso, vacan, asomeno"],"size":[1800],"topic_no":[8],"thought_1":[],"thought_2":[],"prob":["mapear, tiempo, hora, ayer, persona, contacto, perder"],"frex":["perdida, godo, rey, good, engañoso, vacan, asomeno"],"lift":["aprobar, ayudant, cena, chofer, educacion, equivoco, film"],"score":["mapear, tiempo, ayer, persona, godo, hora, perdida"],"proportion":["0.02"]},{"name":["opcion, recarga, seria, recargar, prestamo, gustaria, modo"],"size":[1800],"topic_no":[10],"thought_1":[],"thought_2":[],"prob":["opcion, solo, poder, tener, deberian, recarga, tambien"],"frex":["opcion, recarga, seria, recargar, prestamo, gustaria, modo"],"lift":["abuelo, acepten, afan, alia, amazon, añadido, apodo"],"score":["opcion, recarga, solo, poder, tener, deberian, recargar"],"proportion":["0.05"]}],"topic_no":[8,10]}],"topic_no":[11,15,18,19,7,5,6,3,9,20,14,8,10]},{"name":["mala, permit, atencion, aplicacion, abrir, bueno, momento"],"children":[{"name":["bueno, atencion, mala, recibida, enojado, frustrado, enojada"],"size":[1800],"topic_no":[1],"thought_1":[],"thought_2":[],"prob":["bueno, abrir, permit, atencion, mala, recibida, enojado"],"frex":["bueno, atencion, mala, recibida, enojado, frustrado, enojada"],"lift":["actuacion, agarrar, atenc, atizar, buna, diseñ, jugado"],"score":["bueno, recibida, atencion, enojado, enojada, abrir, mala"],"proportion":["0.05"]},{"name":["neutra, tanto, merec, aplicacion, impedi, cinco, avanzar"],"size":[1800],"topic_no":[4],"thought_1":[],"thought_2":[],"prob":["aplicacion, momento, recomiendo, estrella, doy, toda, asco"],"frex":["neutra, tanto, merec, aplicacion, impedi, cinco, avanzar"],"lift":["merec, aplicacion, aplicacionactualizacion, aplicacionentretenida, arreglada, barco, cinco"],"score":["aplicacion, momento, recomiendo, estrella, asco, doy, opinion"],"proportion":["0.05"]}],"topic_no":[1,4]},{"name":["rapido, pago, usar, servicio, ayuda, gracia, facil"],"children":[{"name":["facil, rapido, practico, rapida, seguro, super, practica"],"size":[1800],"topic_no":[13],"thought_1":[],"thought_2":[],"prob":["facil, rapido, usar, mejor, mas, practico, efectivo"],"frex":["facil, rapido, practico, rapida, seguro, super, practica"],"lift":["autonomia, grafica, interesant, recomendada, recomendado, sencilla, agil"],"score":["facil, rapido, practico, mejor, usar, super, rapida"],"proportion":["0.06"]},{"name":["gran, facilidad, casa, cola, instant, comis, pago"],"size":[1800],"topic_no":[17],"thought_1":[],"thought_2":[],"prob":["pago, servicio, gracia, ayuda, pagar, mucha, sin"],"frex":["gran, facilidad, casa, cola, instant, comis, pago"],"lift":["acelerar, agilizar, aplicacionpuedo, baya, bode, brindarno, circunstancia"],"score":["pago, gracia, buen, servicio, facilita, pagar, ayuda"],"proportion":["0.09"]}],"topic_no":[13,17]},{"name":["positivo, aprobado, genial, satisfecho, feliz, apuro, saca"],"size":[1800],"topic_no":[12],"thought_1":[],"thought_2":[],"prob":["bien, positivo, aprobado, util, genial, satisfecho, gusta"],"frex":["positivo, aprobado, genial, satisfecho, feliz, apuro, saca"],"lift":["aplauso, afectivo, agilidad, agradecido, aplicacionamoroso, apreciado, asa"],"score":["aprobado, positivo, bien, genial, util, satisfecho, feliz"],"proportion":["0.1"]},{"name":["perfecto, app, excelent, chever, servicio, buenazo, buena"],"children":[{"name":["buena, ardo, oportuna, arda, nochesamigo, chever, cool"],"size":[1800],"topic_no":[2],"thought_1":[],"thought_2":[],"prob":["buena, chever, cool, oportuna, servici, ardo, recomienda"],"frex":["buena, ardo, oportuna, arda, nochesamigo, chever, cool"],"lift":["aplicacionahi, appdemora, arda, ardo, disipar, exilentem, funcionadl"],"score":["buena, chever, cool, oportuna, servici, ardo, arda"],"proportion":["0.08"]},{"name":["excelent, destacado, felicitacion, buenisima, ahorra, excelentedestacado, bacan"],"size":[1800],"topic_no":[16],"thought_1":[],"thought_2":[],"prob":["excelent, app, servicio, buenazo, perfecto, ahorra, destacado"],"frex":["excelent, destacado, felicitacion, buenisima, ahorra, excelentedestacado, bacan"],"lift":["excelent, felicitacion, ampliament, apel, bajisimo, crece, destacado"],"score":["excelent, app, destacado, buenazo, ahorra, buenisima, servicio"],"proportion":["0.07"]}],"topic_no":[2,16]}],"topic_no":[11,15,18,19,7,5,6,3,9,20,14,8,10,1,4,13,17,12,2,16],"name":["STM Model"],"this_root":[true],"summary":["A topic model with 20 topics, 118215 documents and a 9449 word dictionary."],"proportions":[0.0452,0.0809,0.0316,0.0476,0.056,0.0359,0.0575,0.0234,0.0307,0.0457,0.0549,0.0955,0.0634,0.0107,0.0506,0.0713,0.0897,0.0465,0.0357,0.0273]}
 
 root.x0=0;root.y0=0;update(root);function update(source){var nodes=tree.nodes(root);var height=Math.max(500,nodes.length*barHeight+margin.top+margin.bottom);
  d3.select("svg").transition().duration(duration).attr("height",height);d3.select(self.frameElement).transition().duration(duration).style("height",height+"px");nodes.forEach(function(n,i){n.x=i*barHeight;});
  var node=svg.selectAll("g.node").data(nodes,function(d){return d.id||(d.id=++i);});
  var nodeEnter=node.enter().append("g").attr("class",function(d){if(d.size){return"node leaf"}else{return"node noleaf"}}).attr("transform",function(d){return"translate("+source.y0+","+source.x0+")";}).style("opacity",1e-6);
  nodeEnter.append("rect").data(nodes).attr("y",-barHeight/2).attr("height",barHeight).attr("width",barWidth).style("fill",color).on("click",clickModal);nodeEnter.append("text").attr("dy",3.5).attr("dx",5.5).text(function(d){if (d.children){return d.name;}else{return d.topic_no + ": " + d.name;}});
  d3.selectAll("g.noleaf").append("svg:foreignObject").attr("width",20).attr("height",20).attr("y","-10px").attr("x",barWidth-15).append("xhtml:span").attr("class","control glyphicon glyphicon-minus").attr("width","30").on("click",function(d){click(d);});
  nodeEnter.transition().duration(duration).attr("transform",function(d){return"translate("+d.y+","+d.x+")";}).style("opacity",1);node.transition().duration(duration).attr("transform",function(d){return"translate("+d.y+","+d.x+")";}).style("opacity",1).select("rect").style("fill",color);
  node.exit().transition().duration(duration).attr("transform",function(d){return"translate("+source.y+","+source.x+")";}).style("opacity",1e-6).remove();
  var link=svg.selectAll("path.link").data(tree.links(nodes),function(d){return d.target.id;});link.enter().insert("path","g").attr("class","link").attr("d",function(d){var o={x:source.x0,y:source.y0};return diagonal({source:o,target:o});}).transition().duration(duration).attr("d",diagonal);
  link.transition().duration(duration).attr("d",diagonal);link.exit().transition().duration(duration).attr("d",function(d){var o={x:source.x,y:source.y};return diagonal({source:o,target:o});}).remove();nodes.forEach(function(d){d.x0=d.x;d.y0=d.y;});}
  function click(d){if(d.children){d._children=d.children;d.children=null;}else{d.children=d._children;d._children=null;}update(d);}
  function color(d){return d._children?"#3182bd":d.children?"#c6dbef":"#fd8d3c";}
  function clickModal(d){if(d.size){$("#doc1").text(d.thought_1);$("#doc2").text(d.thought_2);$("#high-prob").text("Highest Probability: "+d.prob);$("#topicModalLabel").text("Topic "+d.topic_no+" Information");$("#frex").text("FREX: "+d.frex);$("#lift").text("Lift: "+d.lift);
  $("#score").text("Score: "+d.score);$("#proportion").text(""+d.proportion);$("#modelBody").hide();$("#clusterBody").hide();$("#topicBody").show();$("#topicModal").modal("show");}else if(d.this_root){$("#topicModalLabel").text("Fitted Model Information");$("#mod1-text").text(d.summary);$("#topicBody").hide();
  $("#clusterBody").hide();$("#modelBody").show();$("#topicModal").modal("show");if ($("#barchartDiv").children().length == 2){proportionChart();}}else{$("#topicModalLabel").text("Cluster Information");$("#clust1-text").text("This cluster comprises topics "+d.topic_no.join(", ")+".");$("#topicBody").hide();$("#modelBody").hide();
  $("#clusterBody").show();$("#topicModal").modal("show");}} function proportionChart(){for(var t=window.innerHeight/3.5,a=window.innerWidth/2.5,r=35,e=35,n=root.proportions.length,o=[.5];o.length<n;)o.push(o[o.length]+1);var i=d3.select("#barchartDiv").append("svg").attr({width:a,height:t,style:"display: block; margin: auto;"}),
  l=d3.scale.linear().domain([0,d3.max(root.proportions)]).range([0,t-r]),s=d3.scale.linear().domain([0,n]).range([0,a-e]),d=d3.scale.linear().domain([0,d3.max(root.proportions)]).range([t-r,0]),p=d3.svg.axis().scale(d).orient("left"),c=d3.svg.axis().scale(s).orient("bottom").tickValues(d3.range(.5,n+.5,1));
  i.selectAll("rect").data(root.proportions).enter().append("rect").attr({x:function(t,r){return r*(a-e)/n+e},y:function(a){return t-l(a)-r},width:(a-e)/n-1,height:l,fill:"orange"}),
  i.append("g").attr({"class":"axis",transform:"translate("+e+","+(t-r)+")"}).call(c),i.append("g").attr({"class":"axis",transform:"translate("+e+")"}).call(p),i.append("text").attr("class","x label").attr("text-anchor","middle").attr("x",a/2).attr("y",t-6).text("Topic")}</script>
  <div class="modal fade" id="topicModal" tabindex="-1" role="dialog" aria-labelledby="topicModalLabel" aria-hidden="true">
  <div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="topicModalLabel">Topic Information</h4></div>
  <div class="modal-body" id="topicBody"><h5>Top Words</h5><ul id="word-list"><li id="high-prob">Highest Probability: </li><li id="frex">FREX: </li><li id="lift">Lift: </li><li id="score">Score: </li></ul><hr><h5>Representative Documents</h5>
  <div id="doc1" class="modal-body scrollbox"></div>
  <br><div id="doc2" class="modal-body scrollbox"></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div><div class="modal-body" id="modelBody"><h5>Summary</h5><span id="mod1-text"></span><hr><div id="barchartDiv">
  <h5>Topic Proportions in Corpus</h5><br></div><br><div class="modal-footer">
  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div><div class="modal-body" id="clusterBody"><h5>Summary</h5><span id="clust1-text"></span><br><br><div class="modal-footer">
  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div></body>
